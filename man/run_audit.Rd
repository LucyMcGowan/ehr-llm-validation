% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{run_audit}
\alias{run_audit}
\title{Run EHR Data Extraction Audit}
\usage{
run_audit(ehr_wide, epic_raw, roadmap)
}
\arguments{
\item{ehr_wide}{Tibble. Extracted EHR data from \code{simulate_ehr_from_epic()}}

\item{epic_raw}{Tibble. Source EPIC data from \code{simulate_epic()}}

\item{roadmap}{Tibble. Mapping of variables to keyword search terms with columns:
\code{variable} and \code{if_missing_search_for}}
}
\value{
A tibble with audit results containing:
\item{patient_id}{Patient identifier}
\item{contact_date}{Date of clinical contact}
\item{variable}{Clinical measurement type}
\item{extracted_value}{Value from EHR extraction}
\item{epic_value}{Ground truth value from EPIC}
\item{reviewed_value}{Validated/corrected value}
\item{finding}{Audit classification (see Details)}
\item{if_missing_search_for}{Keyword searched when data missing}
\item{notes}{Clinical notes}
}
\description{
Compares extracted EHR data against source EPIC data to identify discrepancies,
validate accuracy, and search clinical notes for missing structured data.
}
\details{
Audit classifications:
\describe{
\item{Extracted Value Correct}{Perfect match between extracted and source values}
\item{Extracted Value Incorrect}{Discrepancy detected; source value used for correction}
\item{[Keyword]}{Missing structured data but diagnostic keyword found in notes}
\item{Not Found}{No structured data or relevant keywords identified}
}

The \code{reviewed_value} provides the most reliable value for each measurement:
correct extracted values, corrected values for discrepancies, or NA when unavailable.
}
\examples{
epic_data <- simulate_epic()
ehr_data <- simulate_ehr_from_epic(epic_data)

roadmap <- data.frame(
  variable = c("body_mass_index", "systolic_blood_pressure", "diastolic_blood_pressure"),
  if_missing_search_for = c("Obesity", "Hypertension", "Hypertension")
)

audit_results <- run_audit(ehr_data, epic_data, roadmap)

}
